{"version":3,"file":"react-render-plugin.esm.js","sources":["../src/utils.js","../src/Control.jsx","../src/Socket.jsx","../src/Node.jsx","../src/index.jsx"],"sourcesContent":["export function kebab(str) {\n    const replace = s => s.toLowerCase().replace(/ /g, '-');\n\n    return Array.isArray(str) ? str.map(replace) : replace(str);\n}","/* eslint-disable react/prop-types */\nimport React from 'react';\n\nexport class Control extends React.Component {\n    createRef = el => {\n        const { innerRef, control } = this.props;\n    \n        el && innerRef(el, control);\n    };\n\n    render() {\n        const { className, control } = this.props;\n\n        return (\n            <div\n                className={className}\n                title={control.key}\n                ref={this.createRef}\n            />\n        )\n    }\n}","/* eslint-disable react/prop-types */\nimport React from 'react';\nimport { kebab } from './utils';\n\nexport class Socket extends React.Component {\n    createRef = el => {\n        const { innerRef, type, io } = this.props;\n    \n        el && innerRef(el, type, io);\n    };\n\n    render () {\n        const { socket, type } = this.props;\n\n        return (\n            <div\n                className={`socket ${type} ${kebab(socket.name)}`}\n                title={socket.name}\n                ref={el => this.createRef(el)} // force update for new IO with a same key \n            />\n        )\n    }\n}","/* eslint-disable sort-imports */\n/* eslint-disable react/prop-types */\nimport React from 'react';\nimport { kebab } from './utils';\nimport { Control } from './Control';\nimport { Socket } from './Socket';\nimport './styles.sass';\n\nexport class Node extends React.Component {\n    state = {}\n\n    static getDerivedStateFromProps({ node, editor }) {\n        return {\n            outputs: Array.from(node.outputs.values()),\n            controls: Array.from(node.controls.values()),\n            inputs: Array.from(node.inputs.values()),\n            selected: editor.selected.contains(node) ? 'selected' : ''\n        }\n    }\n    \n    render() {\n        const { node, bindSocket, bindControl } = this.props;\n        const { outputs, controls, inputs, selected } = this.state;\n\n        return (\n            <div className={`node ${selected} ${kebab(node.name)}`}>\n                <div className=\"title\">{node.name}</div>\n                {/* Outputs */}\n                {outputs.map((output) => (\n                    <div className=\"output\" key={output.key}>\n                        <div className=\"output-title\">{output.name}</div>\n                        <Socket type=\"output\" socket={output.socket} io={output} innerRef={bindSocket} />\n                    </div>\n                ))}\n                {/* Controls */}\n                {controls.map(control => (\n                    <Control className=\"control\" key={control.key} control={control} innerRef={bindControl} />\n                ))}\n                {/* Inputs */}\n                {inputs.map(input => (\n                    <div className=\"input\" key={input.key}>\n                        <Socket type=\"input\" socket={input.socket} io={input} innerRef={bindSocket} />\n                        {!input.showControl() && <div className=\"input-title\">{input.name}</div>}\n                        {input.showControl() && <Control className=\"input-control\" control={input.control} innerRef={bindControl} />}\n                    </div>\n                ))}\n            </div>\n        )\n    }\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Node } from './Node';\n\nfunction install(editor, { component: NodeComponent = Node }) {\n    editor.on('rendernode', ({ el, node, component, bindSocket, bindControl }) => {\n        if (component.render && component.render !== 'react') return;\n        const Component = component.component || NodeComponent;\n\n        node.update = () => new Promise((res) => {\n            ReactDOM.render(<Component node={node} editor={editor} bindSocket={bindSocket} bindControl={bindControl} />, el, res)\n        });\n        node._reactComponent = true;\n        node.update();\n    });\n\n    editor.on('rendercontrol', ({ el, control }) => {\n        if (control.render && control.render !== 'react') return;\n        const Component = control.component;\n\n        control.update = () => new Promise((res) => {\n            ReactDOM.render(<Component {...control.props} />, el, res)\n        });\n        control.update();\n    });\n\n    editor.on('connectioncreated connectionremoved', connection => {\n        connection.output.node.update();\n        connection.input.node.update();\n    });\n\n    editor.on('nodeselected', () => {\n        editor.nodes.filter(n => n._reactComponent).map(node => node.update());\n    });\n}\n\nexport { Node } from './Node';\nexport { Socket } from './Socket';\nexport { Control } from './Control';\n\nexport default {\n    name: 'react-render',\n    install\n}"],"names":["kebab","str","replace","s","toLowerCase","Array","isArray","map","Control","el","props","innerRef","control","className","key","createRef","React","Component","Socket","type","io","socket","name","Node","node","bindSocket","bindControl","state","outputs","controls","inputs","selected","output","input","showControl","editor","from","values","contains","install","component","NodeComponent","on","render","update","Promise","res","ReactDOM","_reactComponent","connection","nodes","filter","n"],"mappings":"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"}